# Task 1.4: Generate Auth Schema

## Goal

Generate Better Auth schema and integrate into main schema.

## Steps

1. Ensure auth.ts exports `auth` for CLI:
   ```typescript
   // At bottom of auth.ts (already there)
   export const auth = betterAuth(createAuthOptions({} as GenericCtx));
   ```

2. Generate schema:
   ```bash
   cd packages/backend/convex
   npx @better-auth/cli generate -y --output authSchema.ts --config auth.ts
   ```

3. Update `packages/backend/convex/schema.ts`:
   ```typescript
   import { defineSchema } from "convex/server";
   import { tables as authTables } from "./authSchema";
   // ... other imports

   export default defineSchema(
     {
       ...authTables,
       ...usersSchema,
       // ... other schemas
     },
     { schemaValidation: true }
   );
   ```

4. Add apikey key index to authSchema.ts:
   ```typescript
   apikey: defineTable({ ... })
     .index("userId", ["userId"])
     .index("key", ["key"]),  // Add this
   ```

## Verification

- [ ] Schema generated
- [ ] Main schema imports auth tables
- [ ] TypeScript compiles
- [ ] Convex dev starts

## Next

Task 1.5: Move API Key Verification
