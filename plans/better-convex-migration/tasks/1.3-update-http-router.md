# Task 1.3: Update HTTP Router

## Goal

Update http.ts to use authMiddleware from better-convex.

## Implementation

Update `packages/backend/convex/http.ts`:

```typescript
import "@repo/backend/convex/polyfills";
import { authMiddleware } from "better-convex/auth";
import type { ActionCtx } from "@repo/backend/convex/_generated/server";
import { createAuth } from "@repo/backend/convex/auth";
import { requestId } from "@repo/backend/convex/routes/middleware/requestId";
import { registerPolarRoutes } from "@repo/backend/convex/routes/polar";
import v1 from "@repo/backend/convex/routes/v1";
import { type HonoWithConvex, HttpRouterWithHono } from "convex-helpers/server/hono";
import { Hono } from "hono";
import { logger } from "hono/logger";
import stripAnsi from "strip-ansi";

const app: HonoWithConvex<ActionCtx> = new Hono();

app.use("*", requestId);
app.use("*", logger((...args) => console.info(...args.map(stripAnsi))));

app.get("/.well-known/openid-configuration", (c) =>
  c.redirect("/api/auth/convex/.well-known/openid-configuration")
);

// Better Auth middleware - handles all /api/auth/* routes
app.use(authMiddleware(createAuth));

app.route("/v1", v1);
registerPolarRoutes(app);

export default new HttpRouterWithHono(app);
```

## Key Changes

- Import `authMiddleware` from `better-convex/auth`
- Remove manual `/api/auth/*` route handler
- Add `app.use(authMiddleware(createAuth))`

## Verification

- [ ] TypeScript compiles
- [ ] Auth endpoints work
- [ ] No manual route handler

## Next

Task 1.4: Generate Auth Schema
