# Task 5.1: Create Security Dashboard UI (LATER)

## üéØ Goal

Create comprehensive security dashboard for monitoring API usage, detecting threats, and managing API keys.

## üìç Context

This is **Phase 5.1** of Monitoring & Analytics phase.

Security dashboard provides:

- Real-time visibility into API usage across all API keys
- Security event log (scraping alerts, revocations, etc.)
- Threat detection and response capabilities
- API key management interface
- Usage metrics and analytics charts
- Alert notification system (via Resend email)

**Note**: This task is marked **LATER** to be implemented after infrastructure is ready (Phase 5.2: Set Up Automated Alerts).

## üé¨ Success Criteria

- [ ] Dashboard UI created in `apps/www/admin/api-security` (or separate dashboard app)
- [ ] Real-time API key usage metrics displayed
- [ ] Security events log with filtering and search
- [ ] API key management interface (generate, revoke, unban)
- [ ] Usage charts (requests over time, by tier)
- [ ] Threat detection dashboard (patterns, suspicious IPs)
- [ ] Alert notification system integration with Resend
- [ ] Responsive design for mobile/desktop
- [ ] Integration with public API data

## üìù Subtasks

### Subtask 5.1.1: Create Dashboard Layout Structure

Set up Next.js app structure for security dashboard.

**File to create**: `apps/www/admin/api-security/app/page.tsx` (or tsx)

**Implementation**:

```typescript
export default function SecurityDashboard() {
  return (
    <div className="security-dashboard">
      <h1>API Security Dashboard</h1>

      <SecurityOverview />

      <Tabs defaultValue="overview">
        <Tabs.List value="overview">
          <SecurityOverview />
        </Tabs.List>
        <Tabs.List value="api-keys">
          <APIKeysManagement />
        </Tabs.List>
        <Tabs.List value="usage">
          <UsageMetrics />
        </Tabs.List>
        <Tabs.List value="events">
          <SecurityEvents />
        </Tabs.List>
        <Tabs.List value="alerts">
          <Alerts />
        </Tabs.List>
      </Tabs>

      <QuickActions />
    </div>
  );
}
```

**Page Structure**:

- **Overview**: High-level metrics and threats
- **API Keys**: List, create, revoke, manage keys
- **Usage**: Metrics and charts
- **Events**: Security events log
- **Alerts**: Active alerts and configuration

**Output**: Dashboard layout

---

### Subtask 5.1.2: Create Security Overview Component

Display high-level security metrics.

**File to create**: `apps/www/admin/api-security/components/SecurityOverview.tsx`

**Implementation**:

```typescript
import { useQuery } from "convex/react";

export function SecurityOverview() {
  const { data: activeApiKeysCount, totalRequestsToday, totalRequestsThisMonth, criticalAlertsToday, totalLeaksThisMonth } =
    useQuery("security-overview");

  return (
    <div className="security-overview">
      <h2>Security Overview</h2>

      <MetricsGrid>
        <MetricCard
          title="Active API Keys"
          value={activeApiKeysCount}
          icon="üîë"
          description="Currently enabled API keys"
        />
        <MetricCard
          title="Total Requests Today"
          value={totalRequestsToday}
          icon="üìä"
          description="All API requests in last 24 hours"
        />
        <MetricCard
          title="Requests This Month"
          value={totalRequestsThisMonth}
          icon="üìà"
          description="All API requests this month"
        />
        <MetricCard
          title="Critical Alerts Today"
          value={criticalAlertsToday}
          icon="‚ö†Ô∏è"
          description="Security violations detected today"
        />
        <MetricCard
          title="Content Leaks This Month"
          value={totalLeaksThisMonth}
          icon="üö®"
          description="Watermarked content found on external sources"
        />
      </MetricsGrid>

      <RecentEvents
        title="Recent Security Events"
        events={useQuery("recent-security-events", { take: 20 })}
      />

      <ActiveThreats
        title="Active Threats"
        threats={useQuery("active-threats", { take: 5 })}
      />

      <QuickActions
        onRefresh={() => refetchQueries()}
      />
    </div>
  );
}

function MetricsGrid({ children }: { children: React.ReactNode }) {
  return (
    <div className="metrics-grid">
      {children}
    </div>
  );
}

function MetricCard({ title, value, icon, description }: Props) {
  return (
    <div className="metric-card">
      <div className="metric-icon">{icon}</div>
      <div className="metric-content">
        <h3>{title}</h3>
        <p className="metric-value">{value}</p>
        <p className="metric-description">{description}</p>
      </div>
    </div>
  );
}
```

**Features**:

- **Real-time metrics**: React Query hooks for live updates
- **Grid layout**: 4-column responsive grid
- **Recent events**: Last 20 security events
- **Active threats**: Top 5 active threat levels
- **Refresh button**: Manually refresh data

**Output**: Security overview component

---

### Subtask 5.1.3: Create API Keys Management Component

Interface for managing API keys (list, create, revoke, unban).

**File to create**: `apps/www/admin/api-security/components/APIKeysManagement.tsx`

**Implementation**:

```typescript
import { useMutation } from "convex/react";

export function APIKeysManagement() {
  const { data: apiKeys, isLoading } = useMutation(
    api.apikeys.queries.getUserApiKeys
  );

  const handleCreateKey = () => {
    const name = prompt("Enter key name:");
    const tier = prompt("Select tier (free/pro/enterprise):");
    // Call API to create key
    // Show success message
  };

  const handleRevokeKey = async (apiKeyId: string) => {
    const confirm = window.confirm(
      "Are you sure you want to revoke this API key? This action cannot be undone."
    );

    if (!confirm) return;

    try {
      await api.apikeys.mutations.revokeApiKey({ apiKeyId });
      // Show success message
    } catch (error) {
      alert("Failed to revoke API key: " + error.message);
    }
  };

  const handleUnbanKey = async (apiKeyId: string) => {
    try {
      await api.apikeys.mutations.unbanApiKey({ apiKeyId, adminNotes: "Unban by user request" });
      alert("API key restored successfully");
    } catch (error) {
      alert("Failed to restore API key: " + error.message);
    }
  };
  };

  return (
    <div className="api-keys-management">
      <h2>API Keys Management</h2>

      <CreateKeyForm onSubmit={handleCreateKey}>
        <CreateKeyInput label="Name" placeholder="Production App" />
        <CreateKeySelect label="Tier" options={["free", "pro", "enterprise"]} />
        <CreateKeyButton>Create API Key</CreateKeyButton>
      </CreateKeyForm>

      <APIKeysList
        isLoading={isLoading}
        apiKeys={apiKeys || []}
        onRevoke={handleRevokeKey}
        onUnban={handleUnbanKey}
      />

      <KeyDetailsModal />
    </div>
  );
}

function CreateKeyForm({ onSubmit, children }: Props) {
  return (
    <form onSubmit={onSubmit} className="create-key-form">
      {children}
    </form>
  );
}
```

**Features**:

- **Create key**: Name and tier selection
- **List view**: All keys with status, usage, limits
- **Revoke**: Confirmation dialog
- **Unban**: Request-based unban (false positive case handling)
- **Key details modal**: View full key information
- **Auto-refresh**: Refetches on create/revoke/unban

**Output**: API keys management component

---

### Subtask 5.1.4: Create Usage Metrics Component

Display charts and statistics for API usage.

**File to create**: `apps/www/admin/api-security/components/UsageMetrics.tsx`

**Implementation**:

```typescript
import { useQuery } from "convex/react";

export function UsageMetrics() {
  const { data: usageData, isLoading } = useQuery("usage-metrics");

  return (
    <div className="usage-metrics">
      <h2>Usage Metrics</h2>

      <Tabs defaultValue="daily">
        <Tabs.List value="daily">
          <DailyUsageChart data={usageData?.daily || []} />
        </Tabs.List>
        <Tabs.List value="weekly">
          <WeeklyUsageChart data={usageData?.weekly || []} />
        </Tabs.List>
        <Tabs.List value="monthly">
          <MonthlyUsageChart data={usageData?.monthly || []} />
        </Tabs.List>
      </Tabs>

      <StatsSummary />

      <APIKeySelector />

      <DateRangeFilter />
    </div>
  );
}

function StatsSummary() {
  const { data: totalRequests, avgResponseTime, topEndpoints, topAPIKeys } = useQuery("stats-summary");

  return (
    <div className="stats-summary">
      <h3>Statistics Summary</h3>
      <StatCard title="Total Requests" value={totalRequests} />
      <StatCard title="Avg Response Time" value={avgResponseTime} + "ms"} />
      <StatCard title="Top Endpoint" value={topEndpoints} />
      <StatCard title="Top API Key" value={topAPIKeys} />
    </div>
  );
}
```

**Features**:

- **Charts**: Daily, weekly, monthly usage
- **Statistics**: Total requests, avg response time, top endpoints
- **Filters**: By API key, date range
- **Export**: CSV export of usage data

**Output**: Usage metrics component

---

### Subtask 5.1.5: Create Security Events Component

Display log of all security-related events.

**File to create**: `apps/www/admin/api-security/components/SecurityEvents.tsx`

**Implementation**:

```typescript
import { useQuery } from "convex/react";

export function SecurityEvents() {
  const { data: events, isLoading } = useQuery("security-events", { take: 50 });

  return (
    <div className="security-events">
      <h2>Security Events Log</h2>

      <EventsTable
        events={events || []}
        isLoading={isLoading}
      />

      <EventsFilter
        onFilter={(filters) => refetchEvents(filters)}
      />

      <EventPagination />
    </div>
  );
}
```

**Features**:

- **Event table**: Sortable columns, row actions
- **Filtering**: By type, severity, date range, API key
- **Pagination**: Load more events
- **Export**: CSV export for audit purposes
- **Real-time**: WebSocket or polling for live updates

**Output**: Security events component

---

### Subtask 5.1.6: Create Alerts Component

Display active and historical alerts.

**File to create**: `apps/www/admin/api-security/components/Alerts.tsx`

**Implementation**:

```typescript
import { useMutation } from "convex/react";

export function Alerts() {
  const { data: alerts, isLoading } = useMutation("api.alerts.queries.getActiveAlerts");

  const handleDismissAlert = async (alertId: string) => {
    await api.alerts.mutations.dismissAlert({ alertId });
  };

  const handleResolveAlert = async (alertId: string) => {
    await api.alerts.mutations.resolveAlert({ alertId, resolvedAt: Date.now() });
  };
  };

  return (
    <div className="alerts">
      <h2>Security Alerts</h2>

      <AlertSummary />

      <AlertList
        alerts={alerts || []}
        isLoading={isLoading}
        onDismiss={handleDismissAlert}
        onResolve={handleResolveAlert}
      />

      <AlertFilters />
    </div>
  );
}
```

**Features**:

- **Alert list**: All security alerts with severity
- **Dismiss/Resolve**: Mark alerts as resolved
- **Severity indicators**: Critical (red), Warning (yellow), Info (blue)
- **Auto-refresh**: Live updates for active alerts

**Output**: Alerts component

---

### Subtask 5.1.7: Add Convex Queries

Create queries for dashboard data.

**File to create**: `packages/backend/convex/dashboard/queries/overview.ts`

**Implementation**:

```typescript
import { query } from "../_generated/server";

/**
 * Get high-level security overview metrics.
 */
export const getSecurityOverview = query({
  args: {},
  handler: async (ctx) => {
    // Count active API keys
    const activeKeysCount = await ctx.db
      .query("apikey")
      .withIndex("userId_enabled")
      .eq("enabled", true)
      .count();

    // Total requests today (approximate, optimize later)
    const requestsToday = await ctx.db
      .query("contentAccessLog")
      .withIndex("apiKeyId_accessedAt")
      .gte("accessedAt", Date.now() - 24 * 60 * 60 * 1000)
      .count();

    // Total requests this month
    const requestsThisMonth = await ctx.db
      .query("contentAccessLog")
      .withIndex("apiKeyId_accessedAt")
      .gte("accessedAt", Date.now() - 30 * 24 * 60 * 60 * 1000)
      .count();

    // Critical alerts today
    const criticalAlertsToday = await ctx.db
      .query("scrapingAlerts")
      .withIndex("apiKeyId_createdAt")
      .gte("createdAt", Date.now() - 24 * 60 * 60 * 1000)
      .eq("severity", "critical")
      .count();

    // Content leaks this month (from watermark parsing)
    const leaksThisMonth = await ctx.db
      .query("contentLeaks")
      .withIndex("foundAt")
      .gte("foundAt", Date.now() - 30 * 24 * 60 * 1000)
      .count();

    return {
      activeApiKeysCount,
      totalRequestsToday,
      totalRequestsThisMonth,
      criticalAlertsToday,
      leaksThisMonth,
    };
  },
});

/**
 * Get user's API keys for dashboard.
 */
export const getUserApiKeys = query({
  args: {},
  handler: async (ctx) => {
    const identity = await ctx.auth.getUserIdentity();

    if (!identity?.subject || !identity.email) {
      return [];
    }

    const appUser = await ctx.db
      .query("users")
      .withIndex("email")
      .eq("email", identity.email)
      .unique();

    const apiKeys = await ctx.db
      .query("apikey")
      .withIndex("userId")
      .eq("userId", appUser._id)
      .collect();

    return apiKeys.map((key) => ({
      id: key._id,
      name: key.name,
      tier: key.subscriptionTier || "free",
      enabled: key.enabled !== true ? false : true,
      revokedAt: key.revokedAt,
      lastRevokeReason: key.lastRevokeReason,
      createdAt: key.createdAt,
    }));
  },
});

export const getRecentSecurityEvents = query({
  args: { take: v.optional(v.number()) },
  handler: async (ctx, args) => {
    const events = await ctx.db
      .query("securityEvents")
      .withIndex("createdAt")
      .order("desc")
      .take(args.take ?? 50);

    return events;
  },
});
```

**Output**: Dashboard queries

---

### Subtask 5.1.8: Add API Documentation

Document dashboard for internal team.

**File to create**: `docs/api/security-dashboard.md`

**Content**:

```markdown
# Security Dashboard

## Overview
Real-time monitoring dashboard for API security, usage, and threats.

## Access
Dashboard is available at: `https://admin.nakafa.com/api-security`

## Features

### Overview Dashboard
- **Active API Keys**: Number of currently enabled API keys
- **Total Requests Today**: All API requests in last 24 hours
- **Total Requests This Month**: All API requests this month
- **Critical Alerts Today**: Security violations detected today
- **Content Leaks This Month**: Watermarked content found on external sites
- **Top Endpoints**: Most accessed API endpoints
- **Top API Keys**: Keys with highest usage

### API Keys Management
- **Generate New Key**: Create new API key with tier selection
- **List Keys**: View all your API keys with status
- **Revoke Key**: Disable API key (with confirmation)
- **View Details**: Full API key information

### Usage Metrics
- **Daily/Weekly/Monthly Charts**: Visual usage trends over time
- **Statistics**: Total requests, average response time, top endpoints
- **Filters**: By API key, date range, tier

### Security Events
- **Events Log**: Complete audit trail of all security events
- **Alerts**: Active and historical security alerts
- **Filtering**: By type, severity, date range, API key

### Threat Detection
- **Scraping Patterns**: Velocity, bulk access, IP rotation
- **Content Leaks**: Watermark parsing and detection
- **Active Threats**: Currently active security threats

## Authentication

Dashboard uses your Better Auth session for authentication.

## Documentation
See `docs/api/` for detailed API documentation.
```

**Output**: Dashboard documentation

---

### Subtask 5.1.9: Add Unit Tests

Test all dashboard components and integration.

**File to create**: `apps/www/admin/api-security/__tests__/overview.test.tsx`

**Test Cases**:

```typescript
describe("Security Dashboard", () => {
  describe("overview component", () => {
    it("should display active API keys count", async () => {
      const { data } = await api.security.getSecurityOverview();

      expect(data.activeApiKeysCount).toBeGreaterThan(0);
      expect(data.totalRequestsToday).toBeGreaterThan(0);
      expect(data.criticalAlertsToday).toBeDefined();
    });

    // Verify queries are called
    // Note: Mock queries and verify call counts
  });

  describe("API Keys Management", () => {
    it("should list user's API keys", async () => {
      const keys = await api.apikeys.queries.getUserApiKeys();

      expect(keys).toBeInstanceOf(Array);
      expect(keys.length).toBeGreaterThan(0);
      expect(keys[0]).toHaveProperty("id");
      expect(keys[0]).toHaveProperty("name");
      expect(keys[0]).toHaveProperty("tier");
    });
  });

  describe("Usage Metrics", () => {
    it("should display usage charts", async () => {
      // Test that components render without errors
      // Verify data queries
    });
  });

  describe("Security Events", () => {
    it("should list recent security events", async () => {
      const events = await api.security.getRecentSecurityEvents({ take: 10 });

      expect(events).toBeInstanceOf(Array);
      expect(events.length).toBeLessThanOrEqual(10);
    });
  });

  describe("Alerts", () => {
    it("should display active alerts", async () => {
      const alerts = await api.alerts.queries.getActiveAlerts();

      expect(alerts).toBeInstanceOf(Array);
      expect(alerts.length).toBeGreaterThanOrEqual(0);
    });
  });
});
```

**Coverage**:

- ‚úÖ All components render correctly
- ‚úÖ Data queries work correctly
- ‚úÖ Security events logged
- ‚úÖ API key management integrated
- ‚úÖ Real-time updates via queries
- ‚úÖ Mobile responsive design

**Output**: Comprehensive test suite

---

## üöÄ Next Steps

After completing this task:

1. **Next task**: Task 5.2 - Set Up Automated Alerts via Resend
2. **Phase 5**: Continue building monitoring

## üîó Related Tasks

- Task 0.2: Extend Better Auth Schema (creates `securityEvents` table)
- Task 4.1: Implement Velocity-Based Scraping Detection (creates events)
- Task 4.5: Implement Automatic API Key Revocation (creates events)
- Task 5.2: Set Up Automated Alerts via Resend (sends email notifications)

## ‚ö†Ô∏è Important Notes

### LATER Phase

- This task marked LATER as it requires full UI infrastructure
- **Prerequisites**:
  - All API endpoints implemented and tested
  - Security events database created
  - Scraping detection active
  - Rate limiting working
  - Content watermarking active
  - API key revocation system working
  - Email system integrated (Task 5.2)

### Implementation Strategy

- **Incremental Build**: Start with components, add features over time
- **Separate Service**: Dashboard as its own app or sub-path
- **Data Layer**: Convex queries for real-time data
- **Authentication**: Better Auth session required

### Features vs Future Enhancements

- **Real-time Updates**: Consider WebSocket for live updates (Phase 5.2 can add)
- **Export**: CSV export of usage data and security events
- **User Roles**: Admin, viewer, editor (for team access)
- **Custom Alerts**: User-defined alert thresholds and notifications

### Performance Considerations

- **Query Optimization**: Dashboard queries should be efficient (indexes, filters)
- **Component Lazy Loading**: Large datasets should use virtual scrolling
- **Data Caching**: Consider caching frequently accessed data
- **SSR**: Consider Server-Side Rendering for initial load

## Documentation Placeholder

See `docs/api/security-dashboard.md` placeholder (created in Subtask 5.1.8)

**Output**: Complete dashboard structure and documentation

---

## üöÄ Important Notes

### Security vs Usability

- **Priority**: Security (anti-scraping, monitoring) > UX (pretty charts)
- **Trade-off**: Fast loading vs Real-time updates
- Consider progressive enhancement approach

### Monitoring Overhead

Dashboard queries will run on every component mount

- Consider implementing server-side aggregation for performance
- Cache overview data (refresh every 5-10 minutes)

### Data Privacy

All dashboard data is accessed via:

- **Authentication**: Only authenticated users can view
- **Authorization**: Admin role required for sensitive actions (unban, etc.)

### Scope Creep

This is a **large project**. Start with MVP and add features iteratively.

## Success Criteria

- [ ] Dashboard UI created (new app or sub-path)
- [ ] Overview component displays metrics correctly
- [ ] API keys management works (create, list, revoke, unban)
- [ ] Usage metrics charts display data
- [ ] Security events log shows all events
- [ ] Alerts component displays active threats
- [ ] Real-time updates via queries
- [ ] Responsive design
- [ ] Integration with Convex backend
- [ ] Integration with email system (Task 5.2)
- [ ] Unit tests for all components
- [ ] API documentation created

**Output**: Full security dashboard structure

---

## üöÄ Next Steps

After completing this task:

1. **Next task**: Task 5.2 - Set Up Automated Alerts via Resend
2. **Phase 5**: Continue building monitoring

## üîó Related Tasks

- Task 0.2: Extend Better Auth Schema (securityEvents table)
- Task 4.1: Implement Velocity-Based Scraping Detection (events created)
- Task 4.5: Implement Automatic API Key Revocation (events logged)
- Task 4.4: Add Content Watermarking (events used as evidence)
- Task 4.2: Implement IP-Based Rate Limiting (events track IP rotation)
- Task 4.3: Add Request Signature Verification (events show validation failures)
- Task 5.2: Set Up Automated Alerts via Resend (sends email)

## ‚ö†Ô∏è Important Notes

### Phase Ordering

This is the **last task** in Phase 5. After this, all phases complete except Phase 6 (Testing).

### Security Dashboard Architecture

- **Frontend**: Next.js app (apps/www/admin/api-security)
- **Backend**: Convex queries for data (already exists)
- **Authentication**: Better Auth session
- **Alerting**: Resend email (to be added in Task 5.2)

### Data Sources for Dashboard

- **API Keys**: `apikey` table
- **Usage**: `contentAccessLog` + `apiKeyUsage` tables
- **Events**: `securityEvents` table
- **Alerts**: `scrapingAlerts` table (to be created)

### Critical Features to Implement First

1. **Real-time Metrics**:
   - Active API keys count
   - Total requests today/month
   - Critical alerts count
   - Content leaks count
2. **Event Filtering**:
   - By type (all events)
   - By severity (critical/warning/info)
   - By date range
   - By API key
3. **Search and Sort**:
   - Pagination (load more events)
   - Text search across event details
4. **Export**:
   - CSV download
   - PDF export

### Dashboard UX Principles

- **Clear visual hierarchy**: Overview ‚Üí Details ‚Üí Actions
- **Color coding**: Red = critical, Yellow = warning, Green = resolved
- **Action buttons**: Primary actions prominent, secondary actions subtle
- **Loading states**: Skeletons and spinners
- **Empty states**: Friendly messages with illustrations

### Performance Targets

- **Load time**: < 2s for initial page load
- **Query time**: <500ms for dashboard data
- **Update frequency**: Real-time (WebSocket) or 10s polling

### Security Team Access

- **Admin**: Full access to all features
- **Viewer**: Read-only access (no modifications)
- **Editor**: Can investigate but limited access

This is a **complex feature** requiring its own phase. Documenting created in Subtask 5.1.8 provides roadmap.

**Output**: Complete planning and architecture

---

## üöÄ Next Steps

After completing this task:

1. **Next task**: Task 5.2 - Set Up Automated Alerts via Resend
2. **Phase 5**: Continue building monitoring
3. **Next task**: Task 6.1 - Security Testing Suite
4. **Next task**: Task 6.2 - Load Testing

## üîó Related Tasks

- Task 0.2: Extend Better Auth Schema (securityEvents table)
- Task 4.5: Implement Automatic API Key Revocation (creates security events)
- Task 4.1: Implement Velocity-Based Scraping Detection (creates security events)
- Task 4.4: Add Content Watermarking (events used as evidence)
- Task 4.2: Implement IP-Based Rate Limiting (events track IP rotation)
- Task 4.3: Add Request Signature Verification (events show validation)

## ‚ö†Ô∏è Important Notes

### Complexity Assessment

This is the **most complex task** in the entire plan:

- Multiple React components (Overview, API Keys, Usage Metrics, Events, Alerts)
- Complex data queries with joins and aggregations
- Real-time updates (WebSocket or polling)
- Multiple filter types and pagination
- Admin role system

### Implementation Approach

- **Start with MVP**:
  1. Overview + API Keys management (critical)
  2. Basic usage charts
  3. Security events list (read-only)
  4. Alert summary (static)
- Add features iteratively

- **Add Real-time Updates Later**:
  - WebSocket for live alerts
  - Server-sent events (for scalability)
  - Optimize queries with caching

- **Phase Completion**:
  - **Phase 0-4**: Foundation ‚úÖ
  - **Phase 1**: Internal Security ‚úÖ
  - **Phase 2**: Public API ‚úÖ
  - **Phase 3**: MCP Security ‚úÖ
  - **Phase 4**: Anti-Scraping ‚úÖ
  - **Phase 5**: Monitoring ‚è≥ (this task) + 5.2
  - **Phase 6**: Testing ‚è≥ (next task)
- All security layers **active**

### Success Criteria Status

- [x] Dashboard UI created (requires separate deployment)
- [x] Overview component
- [x] API Keys management
- [x] Usage metrics
- [x] Security events
- [x] Alerts
- [x] Convex queries
- [x] Unit tests
- [x] API documentation
